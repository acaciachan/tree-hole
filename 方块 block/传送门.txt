旧版本地狱门(1.15-)：

(竖直)相对位置=(原门最高门方块y + 1 - 实体y)÷ 原门高
实体传送y坐标=新门最高门方块y - (竖直)相对位置 * 新门高 + 1

原门和新门的最高传送门方块，原门和新门的门高度：合法黑曜石框架正常判断，不合法的黑曜石框架视为1x1门。


新版本地狱门(应该是自从1.16.3+)：

获取两侧门的结构：
本侧的门：
实体接触到传送门时，本侧的门大小结构是由实体碰撞到的地狱门方块决定的，这个与门的碰撞判断是吧地狱门方块作为完整的方块来看待；
如果实体同时碰到多个地狱门，则按照x-y-z顺序找那个坐标数值最大的门的方块，作为本侧门地狱门查找结构的起始点。(checkInsideBlocks的三个for循环坐标轴从小到大，x在最外面，z在最里面)

对面的门：
实体坐标乘或除以8算出对面的“对应位置(小数)”，找到(获取POI)距离“对应位置”最近的一个地狱门方块作为“起始方块”
这里的查找是这样子的：
	1. 每个地狱门方块都是一个POI，建议对面的地狱门少做点以提升查找POI的效率
	2. 查找的最大区域是一个水平方形距离128(主世界)或16(非主世界)的区域，垂直高度不限制，只有在这个区域里面的门才能被选中
	3. 找的时候找距离上述“对应位置”直线距离最近的门，距离相同就看谁的垂直距离更近，最后选出一个“起始门方块”
	4. 这个“起始方块”所在的区块正是加载的中心区块，根据这个方块探测出对面完整的门的大小结构等，这样就找到了对面一个完整的门

实体前后的位置百分数保持一致：
获取到了两侧的门的大小结构，实体在其中的相对位置也要在传送前后保持一致。实体检测在门中的位置时只考虑平行于门平面的位置(左右和上下)，不考虑内外的位置(垂直于门)。
水平方向：
当实体紧贴门的西或北侧(负数方向)时，水平位置百分数为0；
当实体紧贴门的东或南侧(正数方向)时，水平位置百分数为1；
当实体在门的正中间时候，水平位置百分数为0.5。
垂直方向：
当实体脚踩着门底部时，竖直位置百分数为0；
当实体头顶着门顶部时，竖直位置百分数为1。

传送后，实体的不同门的两个方向的位置百分数会保持一致。实际的效果就是，传送前紧贴着西侧的门框，传送后即使门的大小不一样也依然是紧贴着西侧的，传送前是脚踩门底部的，传送后也是。

超限情况：
如果传送前实体的位置百分数不在0~1范围内，传送前小于0的传送后设置为0，传送前大于1的传送后设置为1，也就是传送前超过0~1范围的传送后会限制到0~1的范围。
如果实体比传送后的门宽，传送后的水平位置百分数会设置为0.5，也就是传送后在水平正中间；如果实体比传送后的门高，数值百分数会设置为0，也就是传送后脚踩着门底。

在1.19某版本开始还会额外考虑实体传送之后会不会卡到方块里，如果会，在还会尝试在三个方向调整传送后的位置到不会碰撞。此时如果实体出口位置周围存在大量碰撞箱，尤其是例如炼药锅、粪桶、漏斗等非常复杂的碰撞箱，会极大地提高计算量。

实体朝向：如果传送前后的两个门都是在坐标轴上是同一个方向的，保持实体的偏航角不变，如果门的朝向不一样，则偏航角+90度(向右旋转90度)。

原文草稿：
先查找地狱门： net.minecraft.entity.Entity#getPortalRect 
计算一律从传送门的西北角开始，西北侧为0，东南侧为1 
net.minecraft.world.dimension.NetherPortal#entityPosInPortal 
确定两个参数：位置比例和坐标轴，从西北角开始，为0，东南角为1；如果找不到原始地狱门，默认在x轴正中间（0.5） 
MC保证实体不会和地狱门边界相撞，如果实体y过大，取0，xz过大则取0.5 
和地狱门正交方向上的坐标不变 
然后进入 net.minecraft.world.dimension.NetherPortal#getNetherTeleportTarget 
Yaw和速度偏转：如果原始地狱门和目标地狱门xz朝向不一致，偏航角旋转90度 
将原来0～1的数字映射到新的地狱门大小 
然后net.minecraft.world.dimension.NetherPortal#findOpenPosition 
如果实体大小太大（任意轴>4），跳过 
以计划传送目的地的实体中心为底部，xz大小不变，y大小=1，寻找最近的碰撞 
如果找不到，使用原来的坐标 

相关函数：
changeDimension
findDimensionEntryPoint
moveTo

传送后的冷却时间：
	玩家：10t = 0.5s，
	载具(船和矿车)：10t = 0.5s
	投掷物：2t = 0.1s
	其他实体：300t = 15s




进入末地相关：

刷新黑曜石平台
5x5黑曜石平台中间的黑曜石上方的空气方块为(0,0,0)
for z=[-2,+2]
	for x=[-2,+2]
		for y=[-1,3]
		A设置为 y=-1 ? 黑曜石 ：空气
		如果这个位置不是A
			拆掉当前位置方块
			放置A方块
			
主世界猪人塔：
		
	下界门或自然生成的僵尸猪灵，每只掉落经验的期望值为：
	7*0.95 + 14*0.05 = 147/20 = 7.35XP
	
	耐久3+经验修补下，72k挖掘，需要的地狱门最少数量：
	1 / ((3/4096)*(3/2000)) / (7.35XP * 2修复 * 4倍耐久)
	≈ 15480 (下界传送门方块)
	≈ 21^2(最大门) * 35.1(最大门数量)
	此部分缺少实测，43门可能会碎镐子，已知45、46个门是没问题的